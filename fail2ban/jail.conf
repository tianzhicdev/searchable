[DEFAULT]
# Ban IP for 1 hour after 5 failures
bantime = 3600
findtime = 600
maxretry = 5
backend = systemd

# Email notifications (optional - configure if needed)
# destemail = admin@yourdomain.com
# sendername = Fail2Ban
# action = %(action_mwl)s

# Default action: ban only
action = %(action_)s

[sshd]
enabled = true
port = ssh
logpath = %(sshd_log)s
maxretry = 3
bantime = 86400  # 24 hours for SSH

# Note: For Docker environments, nginx logs should be mounted to a persistent location
# Update the logpath variables in jail.local to match your setup:
# For production: /home/searchable/searchable/logs/nginx/
# For local Docker: ./logs/nginx/

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
# Override in jail.local with actual path

[nginx-noscript]
enabled = true
port = http,https
filter = nginx-noscript
# Override in jail.local with actual path
maxretry = 3

[nginx-badbots]
enabled = true
port = http,https
filter = nginx-badbots
# Override in jail.local with actual path
maxretry = 2

[nginx-noproxy]
enabled = true
port = http,https
filter = nginx-noproxy
# Override in jail.local with actual path
maxretry = 2

[nginx-req-limit]
enabled = true
filter = nginx-req-limit
port = http,https
# Override in jail.local with actual path
maxretry = 10
findtime = 60
bantime = 7200  # 2 hours for rate limit violations

# Custom filter for suspicious API patterns
[searchable-api]
enabled = true
port = http,https
filter = searchable-api
# Override in jail.local with actual path
maxretry = 10
findtime = 300
bantime = 3600

# Custom filter for failed login attempts
[searchable-auth]
enabled = true
port = http,https
filter = searchable-auth
# Override in jail.local with actual path
maxretry = 5
findtime = 300
bantime = 7200  # 2 hours for auth failures