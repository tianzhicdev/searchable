# Searchable Platform Fail2ban Configuration
# Place this file in /etc/fail2ban/jail.d/searchable.conf

# Only enable the most critical jails for production
# These protect against the most common attacks

[nginx-limit-req]
enabled = true
filter = nginx-limit-req
port = http,https
logpath = /home/searchable/searchable/logs/nginx/error.log
maxretry = 10
findtime = 60
bantime = 7200

[searchable-api-attacks]
enabled = true
filter = searchable-api-attacks
port = http,https
logpath = /home/searchable/searchable/logs/nginx/access.log
maxretry = 5
findtime = 300
bantime = 3600

[searchable-auth-failures]
enabled = true
filter = searchable-auth-failures
port = http,https
logpath = /home/searchable/searchable/logs/nginx/access.log
maxretry = 5
findtime = 300
bantime = 7200